<!DOCTYPE html>
<html lang="en">

<head>
     {% load static %}

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="{% static 'image/csir_logo.ico' %}" type="image/icon type">
    <meta name="keywords"
          content="csir,cimfr,central institute mining and fuel research digital, Council of Scientific and Industrial Research, digital mine, internet of things,
           development, development of digital mine using iot, erp, digital erp, meity,ministry of electronics and information technology,government of india">
    <meta name="description"
          content="The main motive of this software is to digitize the manual workings of the mining industry to make it more efficient and save human lives">

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Development of digital mine using IOT">
    <meta itemprop="description"
          content="We restyled the classic Bootstrap Navbar and we added brand new icons. This navbar comes with 5 vibrant colors: blue, azzure, green, orange and red.">
    <meta itemprop="image" content="https://s3.amazonaws.com/creativetim_bucket/products/18/opt_navbar_thumbnail3.jpg">


    <title>Digital Mine(IoT) | Dashboard</title>

    {% load staticfiles %}
    <!-- Custom fonts for this template-->
    <link rel="stylesheet" href="{% static 'dashboard/vendor/fontawesome-free/css/all.min.css' %}" type="text/css">

    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">

    <!-- Custom styles for this template-->
    <link rel="stylesheet" href="{% static 'dashboard/css/sb-admin-2.min.css' %}">
    <style>
        .loader {
            border: 16px solid #f3f3f3; /* Light grey */
            border-top: 16px solid #3498db; /* Blue */
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        #overlay {
            position: absolute;
            display: none;
            width: auto;
            height: auto;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2;
            cursor: pointer;
        }

        #text {
            position: absolute;
            top: 50%;
            left: 50%;
            font-size: 25px;
            color: white;
            transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
        }
    </style>


  <!--HEADER FOR MINERS TRACKING-->
  <style>

	.KBmap__markerTitle{
		font-family: witcher;
		color: #56270c;
	}
	.KBmap__mapContainer{
		height: 100vh;
		max-height: 100vh;
	}
	.KBmap__mapHolder{
		height: 100%;
		box-shadow:10px 10px 5px #aaaaaa;
	}
	.KBmap__mapHolder img{
		width: auto;
	    height: 100%;
	}
    .strata-dropdown{
        background-color: #4CAF50;
    }

    .strata-dropbtn {
  background-color: #4CAF50;
  color: white;
  font-size: 16px;
  border: none;
  cursor: pointer;
}

.strata-dropdown {
  position: relative;
  display: inline-block;
}

.strata-dropdown-content {
    display: none;
    position: absolute;
    right: 50%;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}

.strata-dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.strata-dropdown-content a:hover {background-color: #f1f1f1}

.strata-dropdown:hover .strata-dropdown-content {
  display: block;
}

.strata-dropdown:hover .strata-dropbtn:hover {
  background-color: #3e8e41;

}
  </style>


    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <link href="{% static  'css/jquery-ui.css' %}" rel="stylesheet" type="text/css">

    <script src="{% static 'js/KBmapmarkers.js' %}"></script>
    <script src="{% static 'js/KBmapmarkersCords.js' %}"></script>


  <!--END-HEADER FOR MINERS TRACKING-->
</head>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

    <!-- Sidebar -->
    <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

        <!-- Sidebar - Brand -->
        <a class="sidebar-brand d-flex align-items-center justify-content-center"
           href="{% url 'dashboard:dashboard_calling' %}">
            <div class="sidebar-brand-icon rotate-n-15">
                <!-- <i class="fas fa-laugh-wink"></i> -->
            </div>
            <div class="sidebar-brand-text mx-3">Digital Mine</div>
        </a>

        <!-- Divider -->
        <hr class="sidebar-divider my-0">

        <!-- Nav Item - Dashboard -->
        <li class="nav-item active">
            <a class="nav-link" href="{% url 'dashboard:dashboard_calling' %}">
                <i class="fas fa-fw fa-tachometer-alt"></i>
                <span>Dashboard</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">

        <!-- Heading -->
        <div class="sidebar-heading">
            Interface
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
               aria-expanded="true" aria-controls="collapseTwo">
                <i class="fas fa-fw fa-cog"></i>
                <span>Components</span>
            </a>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rounded">
                    <h6 class="collapse-header">Custom Components:</h6>
                    <a class="collapse-item" href="buttons.html">Buttons</a>
                    <a class="collapse-item" href="cards.html">Cards</a>
                </div>
            </div>
        </li>

        <!-- Nav Item - Utilities Collapse Menu -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
               aria-expanded="true" aria-controls="collapseUtilities">
                <i class="fas fa-fw fa-wrench"></i>
                <span>Utilities</span>
            </a>
            <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                 data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rprofile_avatarounded">
                    <h6 class="collapse-header">Custom Utilities:</h6>
                    <a class="collapse-item" href="utilities-color.html">Colors</a>
                    <a class="collapse-item" href="utilities-border.html">Borders</a>
                    <a class="collapse-item" href="utilities-animation.html">Animations</a>
                    <a class="collapse-item" href="utilities-other.html">Other</a>
                </div>
            </div>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">

        <!-- Heading -->
        <div class="sidebar-heading">
            Addons
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePages"
               aria-expanded="true" aria-controls="collapsePages">
                <i class="fas fa-fw fa-folder"></i>
                <span>Pages</span>
            </a>
            <div id="collapsePages" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rounded">
                    <h6 class="collapse-header">Login Screens:</h6>
                    <a class="collapse-item" href="login.html">Login</a>
                    <a class="collapse-item" href="register.html">Register</a>
                    <a class="collapse-item" href="forgot-password.html">Forgot Password</a>
                    <div class="collapse-divider"></div>
                    <h6 class="collapse-header">Other Pages:</h6>
                    <a class="collapse-item" href="404.html">404 Page</a>
                    <a class="collapse-item" href="blank.html">Blank Page</a>
                </div>
            </div>
        </li>

        <!-- Nav Item - Charts -->
        <li class="nav-item">
            <a class="nav-link" href="charts.html">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>Charts</span></a>
        </li>

        <!-- Nav Item - Tables -->
        <li class="nav-item">
            <a class="nav-link" href="tables.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Tables</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block">

        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline">
            <button class="rounded-circle border-0" id="sidebarToggle"></button>
        </div>

    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->
            <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                <!-- Sidebar Toggle (Topbar) -->
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars"></i>
                </button>

                <!-- Topbar Search -->
                <form method="POST"
                      class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                    {% csrf_token %}
                    <div class="input-group">
                        <!-- <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..." aria-label="Search" aria-describedby="basic-addon2">
                        <div class="input-group-append">
                          <button class="btn btn-primary" type="button">
                            <i class="fas fa-search fa-sm"></i>
                          </button>
                        </div> -->
                        <select name="mine_name" onchange="this.form.submit()" id="mine" class="form-control">
                            {% for x in mine_table %}
                                {% firstof var1 var2 var3 %}
                                <option {% if selected == x.id %} selected {% endif %}
                                                                  value="{{ x.id }}">{{ x.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </form>

                <!-- Topbar Navbar -->
                <ul class="navbar-nav ml-auto">

                    <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                    <li class="nav-item dropdown no-arrow d-sm-none">
                        <a class="nav-link dropdown-toggle" href="#" id="searchDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <!-- Dropdown - Messages -->
                        <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                             aria-labelledby="searchDropdown">
                            <form class="form-inline mr-auto w-100 navbar-search">
                                <div class="input-group">
                                    <input type="text" class="form-control bg-light border-0 small"
                                           placeholder="Search for..." aria-label="Search"
                                           aria-describedby="basic-addon2">
                                    <div class="input-group-append">
                                        <button class="btn btn-primary" type="button">
                                            <i class="fas fa-search fa-sm"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </li>

                    <!-- Nav Item - Alerts -->
                    <li class="nav-item dropdown no-arrow mx-1">
                        <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-bell fa-fw"></i>
                            <!-- Counter - Alerts -->
                            <span class="badge badge-danger badge-counter">3+</span>
                        </a>
                        <!-- Dropdown - Alerts -->
                        <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                             aria-labelledby="alertsDropdown">
                            <h6 class="dropdown-header">
                                Alerts Center
                            </h6>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="mr-3">
                                    <div class="icon-circle bg-primary">
                                        <i class="fas fa-file-alt text-white"></i>
                                    </div>
                                </div>
                                <div>
                                    <div class="small text-gray-500">December 12, 2019</div>
                                    <span class="font-weight-bold">A new monthly report is ready to download!</span>
                                </div>
                            </a>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="mr-3">
                                    <div class="icon-circle bg-success">
                                        <i class="fas fa-donate text-white"></i>
                                    </div>
                                </div>
                                <div>
                                    <div class="small text-gray-500">December 7, 2019</div>
                                    $290.29 has been deposited into your account!
                                </div>
                            </a>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="mr-3">
                                    <div class="icon-circle bg-warning">
                                        <i class="fas fa-exclamation-triangle text-white"></i>
                                    </div>
                                </div>
                                <div>
                                    <div class="small text-gray-500">December 2, 2019</div>
                                    Spending Alert: We've noticed unusually high spending for your account.
                                </div>
                            </a>
                            <a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                        </div>
                    </li>

                    <!-- Nav Item - Messages -->
                    <li class="nav-item dropdown no-arrow mx-1">
                        <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-envelope fa-fw"></i>
                            <!-- Counter - Messages -->
                            <span class="badge badge-danger badge-counter">7</span>
                        </a>
                        <!-- Dropdown - Messages -->
                        <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                             aria-labelledby="messagesDropdown">
                            <h6 class="dropdown-header">
                                Message Center
                            </h6>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="dropdown-list-image mr-3">
                                    <img class="rounded-circle" src="https://source.unsplash.com/fn_BT9fwg_E/60x60"
                                         alt="">
                                    <div class="status-indicator bg-success"></div>
                                </div>
                                <div class="font-weight-bold">
                                    <div class="text-truncate">Hi there! I am wondering if you can help me with a
                                        problem I've been having.
                                    </div>
                                    <div class="small text-gray-500">Emily Fowler · 58m</div>
                                </div>
                            </a>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="dropdown-list-image mr-3">
                                    <img class="rounded-circle" src="https://source.unsplash.com/AU4VPcFN4LE/60x60"
                                         alt="">
                                    <div class="status-indicator"></div>
                                </div>
                                <div>
                                    <div class="text-truncate">I have the photos that you ordered last month, how would
                                        you like them sent to you?
                                    </div>
                                    <div class="small text-gray-500">Jae Chun · 1d</div>
                                </div>
                            </a>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="dropdown-list-image mr-3">
                                    <img class="rounded-circle" src="https://source.unsplash.com/CS2uCrpNzJY/60x60"
                                         alt="">
                                    <div class="status-indicator bg-warning"></div>
                                </div>
                                <div>
                                    <div class="text-truncate">Last month's report looks great, I am very happy with the
                                        progress so far, keep up the good work!
                                    </div>
                                    <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                                </div>
                            </a>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <div class="dropdown-list-image mr-3">
                                    <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                                         alt="">
                                    <div class="status-indicator bg-success"></div>
                                </div>
                                <div>
                                    <div class="text-truncate">Am I a good boy? The reason I ask is because someone told
                                        me that people say this to all dogs, even if they aren't good...
                                    </div>
                                    <div class="small text-gray-500">Chicken the Dog · 2w</div>
                                </div>
                            </a>
                            <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
                        </div>
                    </li>

                    <div class="topbar-divider d-none d-sm-block"></div>

                    <!-- Nav Item - User Information -->
                    <li class="nav-item dropdown no-arrow">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="mr-2 d-none d-lg-inline text-gray-600 small">Welcome! {{user.username }}</span>
                            <img id="profile_avatar" class="img-profile rounded-circle" src="https://source.unsplash.com/QAB-WJcbgJk/60x60">
                        </a>
                        <!-- Dropdown - User Information -->
                        <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                             aria-labelledby="userDropdown">
                            <a class="dropdown-item" href="/accounts/profile/overview/">
                                <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                Profile
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                Settings
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                Activity Log
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="/accounts/logout" data-toggle="modal" data-target="#logoutModal">
                                <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                Logout
                            </a>
                        </div>
                    </li>

                </ul>

            </nav>
            <!-- End of Topbar -->

            <!-- Begin Page Content -->
            <div class="container-fluid">

                <!-- Page Heading -->
                <div class="d-sm-flex align-items-center justify-content-between mb-4">
                    <h1 class="h3 mb-0 text-gray-800">Dashboard for : {{ first_mine_name }}</h1>
                    <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i
                            class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
                </div>

                <!-- Content Row -->
                <div class="row">

                    <!-- Earnings (Monthly) Card Example -->
                    {% for node in nodes %}
{#                        <h1>{{ key }}</h1>#}
{#                        <h1>{{ node }}</h1>#}
                        {% for key,sensors in node.items %}
{#                            <h1>{{ sensors}}</h1>#}
                            {% for sensor in sensors %}
{#                                <h1>{{ sensor.mine }}</h1>#}
                                    <iframe width="400" height="auto" style="border: none;"src="{% url 'sensor:iframe_live_data' selected sensor.node_id sensor.sensor_id %}"></iframe>
                                {% endfor %}
                            {% endfor %}
                    {% endfor %}
                </div>
                <!-- Content Row -->

                <div class="row">

                    <!-- Area Chart -->
                    <div class="col-xl-12 col-lg-7">
                        <div class="card shadow mb-4">
                            <!-- Card Header - Dropdown -->
                            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                <h6 class="m-0 font-weight-bold text-primary">Strata Condition (Location: <span id="strata_location_name">{{ iframe_strata_location_name }}</span>)</h6>


                                <div class="dropdown no-arrow">
                                    <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                         aria-labelledby="dropdownMenuLink">
                                        <div class="dropdown-header">Choose Strata Location:</div>
                                        {% for location in strata %}
                                            {% for key,loc in location.items %}
                                            <div class="strata-dropdown dropdown-item strata location"  >
                                                <div class="strata-dropbtn" >{{ key }}</div>
                                                <div class="strata-dropdown-content">
                                                   {% for sensor in loc %}
                                                        <a class="strata-location-dropdown" id="{{ sensor.id }}" data-strata-location="{{ sensor.strata_location_id }}">{{sensor.sensor_name}}</a>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        {% endfor %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <!-- Card Body -->

{#                                <div class="chart-area">#}
                                    <div class="container">
{#                                    <canvas id="myAreaChart"></canvas>#}

                                    <div class="embed-responsive embed-responsive-16by9">
                                     <iframe id="strata_monitoring_iframe" class="embed-responsive-item" src="{% url 'Strata:iframe_show_sensor_graph' selected iframe_strata_location iframe_strata_sensor %}"></iframe>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>

                <!-- Content Row -->
                <div class="row">

                    <!-- Content Column -->
                    <div class="col-lg-6 mb-4">

                        <!-- Project Card Example -->
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-primary">Gas Monitoring</h6>
                            </div>
                            <div class="card-body">
                                <div id="overlay" onclick="off()">
                                    <div id="text">Network Error</div>
                                </div>
                                <h4 class="small font-weight-bold">Carbon Dioxide <span id="waterLevel"
                                                                                        class="float-right">20%</span>
                                </h4>
                                <div class="progress mb-4">
                                    <div class="progress-bar bg-danger" role="progressbar" id="waterLevel"
                                         style="width: 20%" aria-valuenow="20" aria-valuemin="0"
                                         aria-valuemax="100"></div>
                                </div>
                                <h4 class="small font-weight-bold">Nitrogen <span id="nitrogen"
                                                                                  class="float-right">40%</span></h4>
                                <div class="progress mb-4">
                                    <div class="progress-bar bg-warning" role="progressbar" id="nitrogen"
                                         style="width: 40%" aria-valuenow="40" aria-valuemin="0"
                                         aria-valuemax="100"></div>
                                </div>
                                <h4 class="small font-weight-bold">Oxygen <span id="oxygen"
                                                                                class="float-right">60%</span></h4>
                                <div class="progress mb-4">
                                    <div class="progress-bar" role="progressbar" id="oxygen" style="width: 60%"
                                         aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <h4 class="small font-weight-bold">Methane <span id="methane"
                                                                                 class="float-right">80%</span></h4>
                                <div class="progress mb-4">
                                    <div class="progress-bar bg-info" role="progressbar" id="methane" style="width: 80%"
                                         aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <h4 class="small font-weight-bold">Hydrogen <span id="hydrogen" class="float-right">Complete!</span>
                                </h4>
                                <div class="progress">
                                    <div class="progress-bar bg-success" id="hydrogen" role="progressbar"
                                         style="width: 100%" aria-valuenow="100" aria-valuemin="0"
                                         aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Color System -->
                        <div class="row">
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-primary text-white shadow">
                                    <div class="card-body">
                                        Primary
                                        <div class="text-white-50 small">#4e73df</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-success text-white shadow">
                                    <div class="card-body">
                                        Success
                                        <div class="text-white-50 small">#1cc88a</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-info text-white shadow">
                                    <div class="card-body">
                                        Info
                                        <div class="text-white-50 small">#36b9cc</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-warning text-white shadow">
                                    <div class="card-body">
                                        Warning
                                        <div class="text-white-50 small">#f6c23e</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-danger text-white shadow">
                                    <div class="card-body">
                                        Danger
                                        <div class="text-white-50 small">#e74a3b</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="card bg-secondary text-white shadow">
                                    <div class="card-body">
                                        Secondary
                                        <div class="text-white-50 small">#858796</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-lg-6 mb-4">

                        <!-- Illustrations -->
{#                        <div class="card shadow mb-4">#}
{#                            <div class="card-header py-3">#}
{#                                <h6 class="m-0 font-weight-bold text-primary">Illustrations</h6>#}
{#                            </div>#}
{#                            <div class="card-body">#}
{#                                <div class="text-center">#}
{#                                    <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;"#}
{#                                         src="{% static 'dashboard/img/undraw_posting_photo.svg' %}" alt="">#}
{#                                </div>#}
{#                                <p>Add some quality, svg illustrations to your project courtesy of <a target="_blank"#}
{#                                                                                                      rel="nofollow"#}
{#                                                                                                      href="https://undraw.co/">unDraw</a>,#}
{#                                    a constantly updated collection of beautiful svg images that you can use completely#}
{#                                    free and without attribution!</p>#}
{#                                <a target="_blank" rel="nofollow" href="https://undraw.co/">Browse Illustrations on#}
{#                                    unDraw &rarr;</a>#}
{#                            </div>#}
{#                        </div>#}
                         <!-- Illustrations -->
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                <h6 class="m-0 font-weight-bold text-primary">Water Level Monitoring</h6>
                                <div class="dropdown no-arrow">
                                    <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                         aria-labelledby="dropdownMenuLink">
                                        <div class="dropdown-header">Dropdown Header:</div>
                                        {% for water in water_level %}
                                            <div class="dropdown-item water location" id="{{ water.id}}">{{ water.area_name }}</div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                             <div class="container">

                      <div class="embed-responsive embed-responsive-16by9">

                          <iframe id="water_monitoring_iframe" class="embed-responsive-item" src="{% url 'water_level_monitoring:iframe_show_graph_water_sensor' selected water_level_id %}"></iframe>
                      </div>
                    </div>
                        </div>

              <!-- Illustrations -->
              <div class="card shadow mb-4">
                <!--<div class="card-header py-3">-->
                  <!--<h6 class="m-0 font-weight-bold text-primary">Illustrations</h6>-->
                <!--</div>-->
                <!--<div class="card-body">-->
                  <!--<div class="text-center">-->
                    <!--<img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;"  src="{% static 'dashboard/img/undraw_posting_photo.svg' %}" alt="">-->
                  <!--</div>-->
                  <!--<p>Add some quality, svg illustrations to your project courtesy of <a target="_blank" rel="nofollow" href="https://undraw.co/">unDraw</a>, a constantly updated collection of beautiful svg images that you can use completely free and without attribution!</p>-->
                  <!--<a target="_blank" rel="nofollow" href="https://undraw.co/">Browse Illustrations on unDraw &rarr;</a>-->
                <!--</div>-->
                <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-primary">Miners Tracking</h6>

                         <li class="MinerWorkerIcon">Worker</li>
                         <li class="MinerOfficerIcon">Officer</li>



                </div>
                  <div class="container">

                      <div class="embed-responsive embed-responsive-16by9">

                          <iframe id="miners_tracking_iframe" class="embed-responsive-item" src="{% url 'MinersTracking:iframe_live_tracking_in_map' selected %}"></iframe>
                      </div>
                    </div>
               <!-- <section class="KBmap" id="KBtestmap"></section>-->

              </div>

                        <!-- Approach -->
{#                        <div class="card shadow mb-4">#}
{#                            <div class="card-header py-3">#}
{#                                <h6 class="m-0 font-weight-bold text-primary">Development Approach</h6>#}
{#                            </div>#}
{#                            <div class="card-body">#}
{#                                <p>SB Admin 2 makes extensive use of Bootstrap 4 utility classes in order to reduce CSS#}
{#                                    bloat and poor page performance. Custom CSS classes are used to create custom#}
{#                                    components and custom utility classes.</p>#}
{#                                <p class="mb-0">Before working with this theme, you should become familiar with the#}
{#                                    Bootstrap framework, especially the utility classes.</p>#}
{#                            </div>#}
{#                        </div>#}


                    </div>
                </div>

            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- End of Main Content -->

        <!-- Footer -->
        <footer class="sticky-footer bg-white">
            <div class="container my-auto">
                <div class="copyright text-center my-auto">
                    <span>Copyright &copy; Your Website 2019</span>
                </div>
            </div>
        </footer>
        <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>

<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary" href="/accounts/logout">Logout</a>
            </div>
        </div>
    </div>
</div>


<!-- Bootstrap core JavaScript-->
<script src="{% static 'dashboard/vendor/jquery/jquery.min.js' %}"></script>
<script src="{% static 'dashboard/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>

<!-- Core plugin JavaScript-->
<script src="{% static 'dashboard/vendor/jquery-easing/jquery.easing.min.js' %}"></script>

<!-- Custom scripts for all pages-->
<script src="{% static 'dashboard/js/sb-admin-2.min.js' %}"></script>

<!-- Page level plugins -->
<script src="{% static 'dashboard/vendor/chart.js/Chart.min.js' %}"></script>

<!-- Page level custom scripts -->
<script src="{% static 'dashboard/js/demo/chart-area-demo.js' %}"></script>
<script src="{% static 'dashboard/js/demo/chart-pie-demo.js' %}"></script>
<script>
    var T;
    $(document).ready(function () {

        window.onunload = function () {
            $.xhrPool.abortAll()
        }
        $.xhrPool = []; // array of uncompleted requests
        $.xhrPool.abortAll = function () { // our abort function
            $(this).each(function (idx, jqXHR) {
                jqXHR.abort();
            });
            $.xhrPool.length = 0
        };

        $.ajax({
           url: "{% url 'employee1:profile_ajax' %}",
           success:function(data){
               T=data;
                if(data.hasOwnProperty('profile_avatar') ){
                    $('img#profile_avatar').attr('src','/media/'+data.profile_avatar);

                }
               if(data.hasOwnProperty('mine')){

                   $('li#mine_name').html(data.mine.substring(data.mine.indexOf('(')+1,data.mine.indexOf(')')));
               }
           },
           error:function(){
                console.log('Something Went Wrong!');
                 $('img#profile_avatar').attr('src','/media/employee_image/male_alt_photo.svg');


           }

        });

        {#$('div.strata.location').click(function(){#}
        {##}
        {#        console.log('strata=> ',strata);#}
        {#        $.xhrPool.abortAll();#}
        {##}
        {#    var StrataCalling = setInterval(function () {#}
        {#        STRATA(strata);#}
        {#        WATER();#}
        {#    }, 5000,strata);#}
        {##}
        {#});#}

        $('a.strata-location-dropdown').click(function(){
             location_id=$(this).attr('data-strata-location');
             sensor_id=this.id
             iframe_link=$('iframe#strata_monitoring_iframe')[0].src;
             new_link=replaceAt(iframe_link,iframe_link.lastIndexOf('/')+1,sensor_id.toString());
             new_link=replaceAt(new_link,new_link.lastIndexOf('/')-1,location_id.toString());

            $('iframe#strata_monitoring_iframe').attr('src',new_link);
           $('span#strata_location_name').text(this.innerText);
        });

        $('div.water.location').click(function(){
                iframe_link=$('iframe#water_monitoring_iframe')[0].src;
                $('iframe#water_monitoring_iframe').attr('src',replaceAt(iframe_link,iframe_link.lastIndexOf('/')+1,this.id.toString()));

        });
        function replaceAt(string, index, replace) {return string.substring(0, index) + replace + string.substring(index + 1);}
        {#function STRATA(strata){#}
        {#    $.ajax({#}
        {#        type: "get",#}
        {#        url: "{% url 'dashboard:fetchsl' %}",#}
        {#        data:{#}
        {#         'strata':strata#}
        {#        },#}
        {#        beforeSend: function (jqXHR) {#}
        {#            $.xhrPool.push(jqXHR);#}
        {#        },#}
        {#        success: function (data) {#}
        {#            console.log(data);#}
        {#            StrataMonitoring(data.result, 100);#}
        {#        },#}
        {#        error: function () {#}
        {#            console.log("something is not right.please contact admin - 1");#}
        {#        }#}
        {#    });#}
        {#}#}
             setInterval(function () {
                WATER();
             },3000
        );

        function WATER(){
            $.ajax({
                type: "get",
                url: "{% url 'dashboard:fetchwl' %}",

                beforeSend: function (jqXHR) {
                    $.xhrPool.push(jqXHR);
                },
                success: function (data) {
                    console.log('water level',data)
                    //StrataMonitoring(data.result,208);
                    GasMonitoring(data.result, 208, "waterLevel");
                    GasMonitoring(getRandomIntInclusive(1, 100), 100, "nitrogen");
                    GasMonitoring(getRandomIntInclusive(1, 100), 100, "oxygen");
                    GasMonitoring(getRandomIntInclusive(1, 100), 100, "methane");
                    GasMonitoring(getRandomIntInclusive(1, 100), 100, "hydrogen");
                    GasMonitoring(getRandomIntInclusive(1, 100), 100, "nodeprogress");
                },
                error: function () {
                    console.log("something is not right.please contact admin - 1");
                }
            });
        }

        document.getElementById("overlay").style.display = "block";


        function StrataMonitoring(strata, UpperLimit) {
            strata = parseFloat(strata);
            {#strata=scale(strata,0,UpperLimit,100,0);#}
            strata = strata.toFixed(2);
            var dt = new Date();
            var time = dt.getHours() + ":" + dt.getMinutes() + ":" + dt.getSeconds();
            {#myLineChart.data.labels.push("Post " + postId++);#}
            if (myLineChart.data.labels.length > 20) {
                myLineChart.data.labels.shift();
                myLineChart.data.datasets[0].data.shift();
            }
            myLineChart.data.labels.push(time);
            myLineChart.data.datasets[0].data.push(strata);
            myLineChart.update()
        }
        const scale = (num, in_min, in_max, out_min, out_max) => {
            return (num - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
        }

        function getRandomIntInclusive(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }


  <!--MINERS TRACKING START-->
var el;

        //alert(img);
function GasMonitoring(waterLevel, UpperLimit, Id) {
            waterLevelPercentage = parseFloat(waterLevel);
            if (waterLevelPercentage < 0.00) {
                document.getElementById("overlay").style.display = "block";
            } else {
                document.getElementById("overlay").style.display = "none";
            }
            waterLevelPercentage = scale(waterLevelPercentage, 0, UpperLimit, 100, 0);
            waterLevelPercentage = waterLevelPercentage.toFixed(2);
            if (waterLevelPercentage < 50) {
                $('div#' + Id).removeClass('bg-danger').addClass('bg-success');
            } else {
                $('div#' + Id).removeClass('bg-success').addClass('bg-danger');
            }

            waterLevelPercentage = waterLevelPercentage + "%";

            $('div#' + Id).width(waterLevelPercentage);

            $('span#' + Id).html(waterLevelPercentage);
        }
    });
</script>
<style>
  .pin{
position:absolute;
height:25px;
width:25px;
background:green;
}
#map_div{
<!--background-position: center;-->
<!--background-size: contain;-->
background-repeat: no-repeat;
}

.list-group{
    max-height: 300px;

    margin-bottom: 10px;
    overflow:scroll;
    -webkit-overflow-scrolling: touch;
}


.services li:before {
content:'';
display:inline-block;
height:1em;
width:1em;
background-image:url('/static/image/router.svg');
background-size:contain;
background-repeat:no-repeat;
padding-left: 2em;
}

.RouterIcon {list-style-image:url('/static/image/router.svg') }
.MinerIcon  { list-style-image:url('/static/image/miner.svg') }
.MinerIconMini  { list-style-image:url('/static/image/miner_mini.svg') }

ul, ol {
  list-style: none;
}
#accordion1 li.panel{
    margin-bottom: 0px;
}
.MinerWorkerIcon  { list-style-image:url('/static/image/miner_worker.svg') }
.MinerOfficerIcon  { list-style-image:url('/static/image/miner_officer.svg') }
</style>
  <!--END- MINERS TRACKING START-->
</body>

</html>
